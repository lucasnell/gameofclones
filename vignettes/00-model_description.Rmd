---
title: "Model description"
author: "Lucas A. Nell"
date: "2018-07-09"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Model description}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  dev = "svglite", 
  fig.width = 6,
  fig.height = 4,
  echo = FALSE
)
```




This document outlines the structure of the model used to estimate population-growth
and plant-deterioration parameters.



## Notes

__on truncated distributions\:__

Below, `T[0,]` indicates that a distribution is truncated to be above zero.


__on normal-distribution notation\:__

Normal distributions below are denoted as $\sim \text{N}(\mu, \sigma)$.


## Scaling in the model

To improve performance, I used scaled log-counts when running the model.
Specifically, I created $\hat{X} = (X - \bar{X}) / s_X$,
where $X$ is a vector of all the non-scaled log counts among all time series.
Thus $\hat{X}$ had a mean of 0 and standard deviation of 1.
All parameters were back-transformed to be on the original scale.


## Model structure

The overall structure of the model is

$$
X_{t+1} = X_t + r \left( 1 - \alpha ~ \text{e}^{\zeta t + X_t} \right) + \varepsilon
\text{ ,}
$$

where $X_t$ is log aphid counts at time $t$,
$r$ is the growth rate,
$\alpha$ is density dependence,
$\zeta$ indicates the speed at which plant health deteriorates through time,
and
$\varepsilon$ is process error.




## Structure of estimates from the model

Growth rates are a random effect by aphid line, where log-transformed 
growth rates are generated as $\sim \text{N}(\rho, \sigma_{\rho})$.
Parameters $\rho$, $\sigma_\rho$, and values for each line are returned by the model.

Density dependences are a random effect by aphid line, where log-transformed 
density dependences are generated as $\sim \text{N}(\phi, \sigma_{\phi})$.
Parameters $\phi$, $\sigma_\phi$, and values for each line are returned by the model.

Process error for each observation is $\sim \text{N}(0, \sigma_{\varepsilon})$, and
$\sigma_{\varepsilon}$ is returned by the model.

Effects of plant health are estimated by plant, where $\zeta$ values
are generated as $\sim \text{N}(0, 1)\texttt{T[0,]}$.
A vector of $\zeta$ values is returned by the model.



